import test from 'ava'
import { integer, string } from '../src/primitives'

test('encodes integers', t => {
  // http://httpwg.org/specs/rfc7541.html#integer.representation.examples
  t.deepEqual(integer(5, 10), [0b01010])
  t.deepEqual(integer(5, 1337), [0b11111, 0b10011010, 0b00001010])
  t.deepEqual(integer(8, 42), [0b00101010])
})

test('encodes strings without huffman encoding', t => {
  // http://httpwg.org/specs/rfc7541.html#request.examples.without.huffman.coding
  t.deepEqual(string('www.example.com', false), [0x0f, 0x77, 0x77, 0x77, 0x2e, 0x65, 0x78, 0x61, 0x6d, 0x70, 0x6c, 0x65, 0x2e, 0x63, 0x6f, 0x6d])
  t.deepEqual(string('custom-key', false), [0x0a, 0x63, 0x75, 0x73, 0x74, 0x6f, 0x6d, 0x2d, 0x6b, 0x65, 0x79])

  // http://httpwg.org/specs/rfc7541.html#response.examples.without.huffman.coding
  t.deepEqual(string('Mon, 21 Oct 2013 20:13:22 GMT', false), [0x1d, 0x4d, 0x6f, 0x6e, 0x2c, 0x20, 0x32, 0x31, 0x20, 0x4f, 0x63, 0x74, 0x20, 0x32, 0x30, 0x31, 0x33, 0x20, 0x32, 0x30, 0x3a, 0x31, 0x33, 0x3a, 0x32, 0x32, 0x20, 0x47, 0x4d, 0x54])
})
